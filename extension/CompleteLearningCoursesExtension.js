sap.ui.define(["sap/ui/integration/Extension"],function(e){"use strict";var t=e.extend("workzone2.workzonehr.sap.sf.workflow.returntoworkplace_employee.CompleteLearningCoursesExtension");t.prototype.init=function(){e.prototype.init.apply(this,arguments);this.validated=false;this.validatePromise=new Promise((e,t)=>{this.resolve=e;this.reject=t})};t.prototype.checkCanSeeCourses=function(){console.log("##Validating... Started? "+this.validated);const e=this.getCard();if(!this.validated){this.validated=true;this.requestSearchItem(e,this.resolve,this.reject)}console.log(this.validatePromise);return this.validatePromise};t.prototype.requestSearchItem=function(e,s,i){e.request({url:"{{destinations.lmsDestination}}/learning/odatav4/public/admin/searchItem/v1/Items?$select=itemID&$filter=contains(criteria/itemTitle,'design')&$format=json",headers:{"successfactors-employment-id":e.getCombinedParameters().loginUser},withCredentials:true}).then(e=>{console.log("###OK in requestSearchItem: "+e);s({canSeeCourses:true})}).catch(o=>{console.log("###NOK in requestSearchItem: ",o);if(o[1].status!==503){s({canSeeCourses:false})}else{console.log("###Retry API for 503");setTimeout(t.prototype.requestSearchItem,1e3,e,s,i)}}).catch(e=>{console.error(e);s({canSeeCourses:false})}).finally(()=>{console.log("###End")})};return t});
